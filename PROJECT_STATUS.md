# –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞ IQStocker v2.0

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (pyproject.toml, docker-compose.yml)
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã Dockerfile'—ã –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã 9 –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö (User, Limits, CSVAnalysis, AnalyticsReport, ThemeTemplate, ThemeRequest, Payment, SystemMessage, BroadcastMessage)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –Ω–∞—á–∞–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è Alembic (001_initial_schema.py)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω async engine –∏ session factory
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –≤—Å–µ repositories (8 —à—Ç—É–∫)

### 3. –°–µ—Ä–≤–∏—Å—ã (Business Logic)
- ‚úÖ UserService - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ø–æ–¥–ø–∏—Å–∫–∏, –±–∞–Ω/—Ä–∞–∑–±–∞–Ω
- ‚úÖ AnalyticsService - –æ–±—Ä–∞–±–æ—Ç–∫–∞ CSV —Ñ–∞–π–ª–æ–≤
- ‚úÖ ThemeService - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–º –∏–∑ –ë–î
- ‚úÖ ReferralService - —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞, IQ –±–∞–ª–ª—ã
- ‚úÖ PaymentService - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Tribute.tg
- ‚úÖ BroadcastService - –º–∞—Å—Å–æ–≤—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏
- ‚úÖ AdminService - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### 4. Telegram Bot
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –≤—Å–µ 12 handlers (start, menu, profile, analytics, themes, lessons, calendar, faq, channel, referral, payments, admin)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã FSM states
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã keyboard factories
- ‚úÖ –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–æ—Ç–∞ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –≤—Å–µ—Ö handlers

### 5. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚úÖ CSVProcessor - –ø–∞—Ä—Å–∏–Ω–≥ CSV —Ñ–∞–π–ª–æ–≤ Adobe Stock
- ‚úÖ KPICalculator - —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ (CPM, –∫–æ–Ω–≤–µ—Ä—Å–∏—è, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫)
- ‚úÖ ReportGenerator - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ—Ç—á–µ—Ç–æ–≤

### 6. Workers
- ‚úÖ ARQ worker –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ CSV —Ñ–∞–π–ª–æ–≤ –≤ —Ñ–æ–Ω–µ
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Redis settings –¥–ª—è ARQ

### 7. –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å FastAPI
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (Basic Auth)
- ‚úÖ Dashboard - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞
- ‚úÖ Users - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (CRUD, –±–∞–Ω, –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏)
- ‚úÖ Payments - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞–º–∏
- ‚úÖ Analytics - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- ‚úÖ Broadcasts - –º–∞—Å—Å–æ–≤—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏
- ‚úÖ Lexicon - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–µ–∫—Å–∏–∫–æ–Ω–∞ –±–æ—Ç–∞

### 8. API Endpoints
- ‚úÖ Health checks
- ‚úÖ Webhook –¥–ª—è Tribute.tg (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π HMAC –ø–æ–¥–ø–∏—Å–∏)

### 9. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚úÖ Tribute.tg –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å—Å—ã–ª–æ–∫
- ‚úÖ HMAC –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è webhook'–æ–≤

### 10. –°–∏—Å—Ç–µ–º–∞ —Ç–µ–º
- ‚úÖ –ú–æ–¥–µ–ª—å ThemeTemplate –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ —Ç–µ–º
- ‚úÖ ThemeTemplateRepository –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–º–∞–º–∏
- ‚úÖ –°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–º –∏–∑ CSV —Ñ–∞–π–ª–∞
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ ThemeService

### 11. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤ (unit –∏ integration)
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ñ–∏–∫—Å—Ç—É—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤ –¥–ª—è UserService, ReferralService, CSVProcessor

### 12. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ README.md - –æ–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ QUICKSTART.md - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- ‚úÖ DEPLOYMENT.md - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é
- ‚úÖ PROJECT_STATUS.md - —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

### 13. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ Alembic –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ structlog
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ Pydantic Settings
- ‚úÖ .gitignore –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞

## üìã –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ–ø–ª–æ–π
- ‚è≥ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Poetry –ª–æ–∫–∞–ª—å–Ω–æ
- ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker —Å–µ—Ä–≤–∏—Å—ã –ª–æ–∫–∞–ª—å–Ω–æ
- ‚è≥ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ
- ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ
- ‚è≥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–µ–ø–ª–æ–π –Ω–∞ Railway.app
- ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ production

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏
- ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ Tribute.tg API (—Å–µ–π—á–∞—Å –∑–∞–≥–ª—É—à–∫–∏)
- ‚è≥ –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- ‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ–ª—å—à–µ unit —Ç–µ—Å—Ç–æ–≤
- ‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ integration —Ç–µ—Å—Ç–æ–≤
- ‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ frontend –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (HTML/CSS/JS)
- ‚è≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–ª–µ—Ä—Ç–æ–≤

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–ú–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö:** 9
- **Repositories:** 8
- **Services:** 7
- **Bot Handlers:** 12
- **Admin Views:** 6
- **API Endpoints:** 3
- **Workers:** 1
- **–¢–µ—Å—Ç—ã:** 4 —Ñ–∞–π–ª–∞ (–ø—Ä–∏–º–µ—Ä—ã)
- **–ú–∏–≥—Ä–∞—Ü–∏–∏:** 1 (–Ω–∞—á–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** 4 —Ñ–∞–π–ª–∞

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `poetry install`
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker: `docker compose up -d`
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏: `poetry run alembic upgrade head`
4. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–º—ã: `poetry run python scripts/load_themes.py`
5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ: `poetry run python -m src.bot.main`
6. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: `poetry run uvicorn src.admin.main:app --reload`
7. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–µ–ø–ª–æ–π –Ω–∞ Railway —Å–æ–≥–ª–∞—Å–Ω–æ DEPLOYMENT.md

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –∑–∞–ø—É—Å–∫—É –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é. –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã.

